<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Audit Analysis — Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body { background-color: #f4f7fc; margin: 0; }
    .navbar-nav .nav-link { position: relative; padding-bottom: 5px; }
    .navbar-nav .nav-link:hover { color: #0d6efd; }
    .navbar-nav .nav-link::after { content:""; position:absolute; left:0; bottom:0; width:0; height:2px; background:#0d6efd; transition:width .3s; }
    .navbar-nav .nav-link:hover::after { width:100%; }

    .hover-box { transition:.3s ease; cursor:pointer; display:flex; flex-direction:column; justify-content:center; align-items:center; aspect-ratio: 1 / 1; border-radius:50%; padding:10px; text-align:center; background:#fff; }
    .hover-box:hover { background: linear-gradient(135deg, #f0f7ff, #e0ecff); transform: scale(1.07); box-shadow: 0 0 15px rgba(13,110,253,.3); }
    .hover-box img { width:40%; height:auto; margin-bottom:6px; transition: transform .3s ease, filter .3s ease; }
    .hover-box:hover img { transform: scale(1.15); filter: brightness(1.2); }
    .hover-box .fw-bold { font-size:.9rem; }
    .hover-box small { font-size:.8rem; }

    .metric-card { background: rgb(0,199,99); border-radius:12px; box-shadow:0 3px 8px rgba(0,0,0,.08); padding:20px; text-align:center; transition: transform .2s ease; height:100%; }
    .metric-card:hover { transform: translateY(-5px); }
    .metric-number { font-size:1.5rem; color:#2e5488; font-weight:bold; }
    .metric-label { font-size:.9rem; color:#fff; font-weight:bold; }

    .bg-blue-section {
      background: url('{{ url_for("static", filename="images/download (2).jpg") }}') no-repeat center center;
      background-size: cover; position: relative; overflow: hidden; border-radius: 12px; flex: 1;
      display:flex; align-items:center; justify-content:center; padding:20px;
    }
    .bg-blue-section::before { content:""; position:absolute; inset:0; background: rgba(0,0,0,.35); backdrop-filter: blur(2px); }
    .bg-blue-section .row { position:relative; z-index:1; }

    .main-row { min-height: calc(100vh - 200px); display:flex; flex-wrap:wrap; }
    .main-row > .col-lg-5, .main-row > .col-lg-7 { display:flex; flex-direction:column; }

    .carousel-inner { flex:1; }
    .carousel-inner img { width:100%; height:100%; object-fit:cover; border-radius:12px; }

    @media (max-width: 991px) {
      .main-row { min-height:auto; }
      .carousel-inner img { height:auto; }
    }
    .hover-fade { transition: all .3s ease; }
    .hover-fade:hover { transform: translateY(-5px); }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm sticky-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <img src="{{ url_for('static', filename='images/mari-energies-logo-png_seeklogo-614423.png') }}" alt="Logo" width="40" class="me-2" />
        <span class="fw-bold">Audit Analysis — Admin</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="#">Company Policies</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">Audits</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Audit Reports</a></li>
              <li><a class="dropdown-item" href="#">New Audit</a></li>
              <li><a class="dropdown-item" href="#">Schedule Audit</a></li>
            </ul>
          </li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('logout') }}">Logout</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- METRICS -->
  <div class="container my-2">
    <div class="row g-3 text-center">
      <div class="col-6 col-md-3"><div class="metric-card"><div id="total-audits" class="metric-number">--</div><div class="metric-label">Total Audits</div></div></div>
      <div class="col-6 col-md-3"><div class="metric-card"><div id="pending-audits" class="metric-number">--</div><div class="metric-label">Pending Audits</div></div></div>
      <div class="col-6 col-md-3"><div class="metric-card"><div id="compliance-rate" class="metric-number">--</div><div class="metric-label">Compliance Rate</div></div></div>
      <div class="col-6 col-md-3"><div class="metric-card"><div id="reports-generated" class="metric-number">--</div><div class="metric-label">Reports Generated</div></div></div>
    </div>
  </div>

  <!-- MAIN -->
  <main>
    <div class="container">
      <div class="row g-4 align-items-stretch main-row">
        <!-- Carousel -->
        <div class="col-12 col-lg-5 hover-fade">
          <div id="mainCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="2500">
            <div class="carousel-inner rounded shadow">
              <div class="carousel-item active">
                <img src="{{ url_for('static', filename='images/purple modern Pie and Bar Chart Graph (Graph).jpg') }}" alt="Slide 1" />
              </div>
              <div class="carousel-item">
                <img src="{{ url_for('static', filename='images/purple modern Pie and Bar Chart Graph (Graph) (1).jpg') }}" alt="Slide 2" />
              </div>
              <div class="carousel-item">
                <img src="{{ url_for('static', filename='images/purple modern Pie and Bar Chart Graph (Graph) (2).jpg') }}" alt="Slide 3" />
              </div>
              <div class="carousel-item">
                <img src="{{ url_for('static', filename='images/purple modern Pie and Bar Chart Graph (Graph) (3).jpg') }}" alt="Slide 4" />
              </div>
            </div>
          </div>
        </div>

        <!-- Circles -->
        <div class="col-12 col-lg-7 hover-fade">
          <div class="bg-blue-section text-white">
            <div class="row g-4 text-center justify-content-center">
              <div class="col-6 col-md-4 col-lg-3">
                <div class="shadow hover-box">
                  <img src="{{ url_for('static', filename='images/icons8-company-48.png') }}" alt="Company" />
                  <div class="fw-bold text-dark">Company Policies</div>
                  <small class="text-muted">Policies</small>
                </div>
              </div>
              <div class="col-6 col-md-4 col-lg-3">
                <div class="shadow hover-box">
                  <img src="{{ url_for('static', filename='images/icons8-audit-report-65.png') }}" alt="Audit Reports" />
                  <div class="fw-bold text-dark">Audit Reports</div>
                  <small class="text-muted">History</small>
                </div>
              </div>
              <div class="col-6 col-md-4 col-lg-3">
                <div class="shadow hover-box">
                  <img src="{{ url_for('static', filename='images/icons8-create-new-48.png') }}" alt="New Audit" />
                  <div class="fw-bold text-dark">New Audit</div>
                  <small class="text-muted">New process</small>
                </div>
              </div>
              <div class="col-6 col-md-4 col-lg-3">
                <div class="shadow hover-box">
                  <img src="{{ url_for('static', filename='images/icons8-schedule-40.png') }}" alt="Schedule" />
                  <div class="fw-bold text-dark">Schedule Audit</div>
                  <small class="text-muted">Plan audit</small>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function fetchMetrics() {
      fetch('{{ url_for("metrics") }}')
        .then(r => r.json())
        .then(d => {
          document.getElementById('total-audits').textContent = d.total_audits;
          document.getElementById('pending-audits').textContent = d.pending_audits;
          document.getElementById('compliance-rate').textContent = d.compliance_rate;
          document.getElementById('reports-generated').textContent = d.reports_generated;
        });
    }
    fetchMetrics();
    setInterval(fetchMetrics, 5000);
  </script>
</body>
</html>
